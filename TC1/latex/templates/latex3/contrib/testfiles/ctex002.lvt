%
% Copyright (C) 2015, 2018 Qing Lee
%

%% We use fandol fonts for testing. In pdftex, they can be only used with dvipdfmx
%% driver. Actually, dvipdfmx is preferred and more frequently used in Chinese
%% typesetting with pdftex.
\begingroup
  \expandafter\ifx\csname pdfoutput\endcsname\relax
    \def\next{}
  \else
    \expandafter\ifx\csname luatexversion\endcsname\relax
      \def\next{\pdfoutput=0\relax}
      \PassOptionsToPackage{driver=dvipdfmx}{expl3}
    \else
      \def\next{}
    \fi
  \fi
\expandafter\endgroup\next


\documentclass{article}
\input{regression-test}
\AUTHOR{Qing Lee}

\usepackage{xparse}
\usepackage{xtemplate}

\START

\ExplSyntaxOn

%% ctex only supports pdftex, xetex and luatex.
\bool_lazy_any:nF
  {
    { \sys_if_engine_pdftex_p: }
    { \sys_if_engine_xetex_p: }
    { \sys_if_engine_luatex_p: }
  }
  {
    \msg_term:n { Not-supported-engine! }
    \END
  }

\ExplSyntaxOff

\OMIT

% Make sure TU encoding is used by fontspec
\PassOptionsToPackage{tuenc}{fontspec}

%% Using fandol fonts for testing
\usepackage[UTF8, heading, fontset = fandol]{ctex}


\begin{document}

\TIMO

\showoutput

你好，世界！

一二三ABC

\end{document}
